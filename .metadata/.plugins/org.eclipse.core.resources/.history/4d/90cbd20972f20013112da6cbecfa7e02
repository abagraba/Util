package com.mimvista.cloud.organizer.verifier;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import au.com.bytecode.opencsv.CSVWriter;

import com.mimvista.cloud.organizer.verifier.panels.VerifierSearchResultView;
import com.mimvista.cloud.organizer.verifier.panels.VerifierSearchResultView.VerifierSearchResultViewEnum;

public class ResultWriter {

	public static void writeToCSV(File output, VerifierSearchResultView[] results, VerifierSearchResultViewEnum[] format, boolean writeHeader) throws IOException{
		CSVWriter writer = new CSVWriter(new FileWriter(output));
		String[] data = new String[format.length];
		for (int i = 0; i < format.length; i++)
			data[i] = format[i].getValue(result);
		writer.writeNext(data);

		for (VerifierSearchResultView result : results) {
			for (int i = 0; i < format.length; i++)
				data[i] = format[i].getValue(result);
			writer.writeNext(data);
		}
		writer.flush();
		writer.close();
	}
	
	
}
