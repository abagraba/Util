package com.mimvista.cloud.organizer.verifier;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import au.com.bytecode.opencsv.CSVWriter;

import com.mimvista.cloud.CloudUtil;
import com.mimvista.cloud.organizer.verifier.panels.VerifierSearchResultView;
import com.mimvista.cloud.organizer.verifier.panels.VerifierSearchResultView.VerifierSearchResultViewEnum;

public class ResultWriter {

	public static void writeToCSV(File output, VerifierSearchResultView[] results, VerifierSearchResultViewEnum[] format, boolean writeHeader)
			throws IOException {
		CSVWriter writer = new CSVWriter(new FileWriter(output));
		String[] data = new String[format.length];
		if (writeHeader) {
			for (int i = 0; i < format.length; i++)
				data[i] = format[i].toString();
			writer.writeNext(data);
		}
		for (VerifierSearchResultView result : results) {
			System.out.println("Writing result");
			for (int i = 0; i < format.length; i++)
				data[i] = format[i].getValue(result);
			writer.writeNext(data);
		}
		writer.flush();
		writer.close();
	}

	public static void writeToJSON(File output, VerifierSearchResultView[] results) throws IOException {
		FileWriter writer = new FileWriter(output);
		for (VerifierSearchResultView result : results)
			writer.write(CloudUtil.gson().toJson(result));
		writer.flush();
		writer.close();
	}

}
